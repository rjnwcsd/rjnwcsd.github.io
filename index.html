<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Control with Joystick and Fire</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            position: relative;
        }
        #smur {
            position: absolute;
            width: 120px;
            height: 120px;
        }
        #fire {
            position: absolute;
            display: none;
            width: 10px;
            height: 10px;
        }
        #black {
            position: absolute;
            display: none;
            width: 1080px;
            height: 10px;
            background-color: black;
        }
    </style>
</head>
<body>
    <img id="smur" src="assets/images/maxresdefault.jpg" alt="Smur Image">
    <img id="fire" src="assets/images/Mario_Fireball.png" alt="Fire Image">
    <div id="black"></div>
    <script>
        const smur = document.getElementById('smur');
        const fire = document.getElementById('fire');
        const black = document.getElementById('black');
        let x = 0;
        let y = 0;
        let fireX = x + smur.width;
        let keys = {}; // Store pressed keys

        const step = 10;
        const fireStep = 10; // Adjust the speed of the fireball
        const screenWidth = window.innerWidth;

        // Initialize gamepad support
        window.addEventListener("gamepadconnected", (event) => {
            const gamepad = event.gamepad;
            // Start listening for gamepad input
            handleGamepadInput(gamepad);
        });

        function handleGamepadInput(gamepad) {
            // Check for joystick input and update character position
            const axes = gamepad.axes;
            const xAxis = axes[0];
            const yAxis = axes[1];

            x += xAxis * step;
            y += yAxis * step;

            // Update the character's position
            smur.style.transform = `translate(${x}px, ${y}px)`;

            // Center the character on the screen
            const viewportWidth = window.innerWidth;
            const viewportHeight = window.innerHeight;

            const translateX = viewportWidth / 2 - x - smur.width / 2;
            const translateY = viewportHeight / 2 - y - smur.height / 2;

            // Translate the body element to follow the character
            document.body.style.transform = `translate(${translateX}px, ${translateY}px)`;

            // Request the next animation frame to keep the gamepad input loop running
            requestAnimationFrame(() => handleGamepadInput(gamepad));

            // Move the fireball
            fireX += fireStep;
            fire.style.transform = `translate(${fireX}px, ${y}px)`;

            // Check if the fireball has gone offscreen, reset it
            if (fireX > screenWidth) {
                fireX = -10; // Place it just off the left side of the screen
                fire.style.transform = `translate(${fireX}px, ${y}px)`;
            }
        }

        // Handle keyboard input for WASD control
        document.addEventListener('keydown', (event) => {
            const key = event.key.toLowerCase();

            // Store the pressed key in the keys object
            keys[key] = true;

            // Update the character's position based on the pressed keys
            updateCharacterPosition();
        });

        document.addEventListener('keyup', (event) => {
            const key = event.key.toLowerCase();

            // Remove the released key from the keys object
            delete keys[key];

            // Update the character's position based on the remaining pressed keys
            updateCharacterPosition();
        });

        function updateCharacterPosition() {
            let xChange = 0;
            let yChange = 0;

            // Check which keys are pressed and calculate the position change accordingly
            if (keys['w']) {
                yChange -= step;
            }
            if (keys['a']) {
                xChange -= step;
            }
            if (keys['s']) {
                yChange += step;
            }
            if (keys['d']) {
                xChange += step;
            }

            // Update the character's position
            x += xChange;
            y += yChange;
            smur.style.transform = `translate(${x}px, ${y}px)`;
        }
    </script>
</body>
</html>
